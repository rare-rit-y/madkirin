#made by _unicornia. (github: rare-rit-y)

bac_coc_debug_cat = {
    bac_skip_to_commonalty_tree = {
        allowed = {
            original_tag = KIC
        }
		visible = {
			is_debug = yes
            has_country_flag = KIC_children_of_concord_flag
			check_variable = { coc_start_foci_completed < 10 }
		}
		complete_effect = {
			set_variable = { coc_start_foci_completed = 10 }
            mark_focus_tree_layout_dirty = yes
			
			every_possible_country = {
				limit = {
					has_character = KIC_rising_sun_u
				}
				KIC_rising_sun_u = { # Rising Sun technical university
					set_character_name = bac_CIT
					set_nationality = PREV.PREV
				}
			}
		}
    
    }
    bac_get_commonalty_start_foci = {
    
        allowed = {
            original_tag = KIC
        }
		visible = {
			is_debug = yes
            has_country_flag = KIC_children_of_concord_flag
			check_variable = { coc_start_foci_completed > 3 }
		}
		complete_effect = {
			set_variable = { coc_start_foci_completed = 0 }
            mark_focus_tree_layout_dirty = yes
		}
    
    }
    bac_get_commonalty_war_tree = {
        allowed = {
            original_tag = KIC
        }
		visible = {
			is_debug = yes
            has_country_flag = KIC_children_of_concord_flag
			NOT = { has_country_flag = COC_war_committee }
		}
		complete_effect = {
			set_country_flag = COC_war_committee
            mark_focus_tree_layout_dirty = yes
		}
    
    }
}
economy_decisions = {
	bac_finish_railway = {
		icon = generic_wreckers
		allowed = { original_tag = KIC }
		visible = {
			has_completed_focus = BAC_COC_eco_head
			NOT = {
				has_railway_connection = {
					start_province = 20626
					target_province = 16648
				}
			}
		}
		available = {
			has_full_control_of_state = 1069
			has_full_control_of_state = 1073
			has_full_control_of_state = 1076
			has_full_control_of_state = 1077
		}
		highlight_states = {
			highlight_state_targets = {
				state = 1069
				state = 1073
			}
		}
		cost = 20
		days_remove = 30
		ai_will_do = {
			factor = 200
		}
		fire_only_once = yes
		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove bac_finish_railway"
			country_event = { id = kirin.36 hours = 1 }
			hidden_effect = {
				build_railway = {
					level = 1
					fallback = yes
					start_province = 16648
					target_province = 20626
				}
			}
		}
		cancel_trigger = {
			hidden_trigger = {
				has_railway_connection = {
					start_province = 20626
					target_province = 16648
				}
			}
		}
	}
}
political_actions = {
	BAC_military_aid_to_civil = {

		icon = generic_industry

		available = {
			has_war = no
			if = {
				limit = { tag = EQC }
				NOT = {
					has_country_flag = is_maresoc
                }
            }
            if = {
			  limit = {
				   original_tag = BAK
				}
				NOT = {
				   has_idea = BAK_elections
				}
			}
			if = {
				limit = {
					tag = WIN
				}
				NOT = {
					has_idea = WIN_chaos_in_the_city
				}
			}
		}

		visible = {
			always = yes
			OR = {
			    if = {
			        limit = { original_tag = TRD }
			        has_government = communism
				}
				if = {
			        limit = { original_tag = TRD }
			        has_government = fascism
				}
			    if = {
			        limit = { original_tag = TRD }
					AND = {
			            has_government = democratic
				        has_completed_focus = TRD_altesburg
					}
				}
			}
			if = {
				limit = { original_tag = BAL }
				NOT = { is_subject_of = CHN }
			}
		}

		fire_only_once = no

		modifier = {
			stability_weekly = 0.005
			command_power_gain = -0.10
			industrial_capacity_factory = -0.1
		}

		days_remove = 180
		days_re_enable = 540

		cost = 100

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision improved_worker_conditions"

		}

		ai_will_do = {
			base = 0
			modifier = {
				add = 1
				has_stability < 0.8
			}
			modifier = {
				add = 1
				has_stability < 0.6
			}
			modifier = {
				add = 5
				has_stability < 0.5
			}
			modifier = {
				add = 10
				has_stability < 0.3
			}
			modifier = {
				factor = 0
				num_of_civilian_factories_available_for_projects < 10
			}
		}
	}
    # EQS_ff_establish_Audit_Office = {
    #     icon = GFX_decision_modern_city
    #     visible = { has_country_flag = EQS_Audit_began }
    #     available = { 
    #         has_completed_focus = eqs_admin_reforms
    #         NOT = { has_country_flag = EQS_HIP_elements_sent }
    #     }
    #     cost = 5
    #     ai_will_do = { factor = 100 }
    #     modifier = {
	# 		political_power_cost = 0.05
	# 	}
    #     fire_only_once = yes
    #     days_remove = 49
    #     complete_effect = {
	# 		log = "[GetDateText]: [Root.GetName]: Decision EQS_ff_establish_Audit_Office"
    #         EQS_applejack = {
    #             unit_leader_event = {
    #                 id = EQS_advisor.510
    #                 days = 2
    #             }
    #         }
	# 	}
    #     remove_effect = {
    #         set_country_flag = EQS_Audit_established
    #         custom_effect_tooltip = EQS_ff_establish_Audit_Office_tt
    #     }
    # }
}
# military_training_category = {
#     EQS_meme_generals = {
# 		icon = generic_prepare_civil_war

# 		allowed = {
# 			original_tag = EQS
# 		}

# 		fire_only_once = yes


# 		cost = 0

# 		complete_effect = {
# 			log = "[GetDateText]: [Root.GetName]: Decision EQS_meme_generals"
# 			set_country_flag = EQS_meme_generals_acquired
#             effect_tooltip = { add_corps_commander_role = { character = EQS_anonfilly } }
# 	        custom_effect_tooltip = anonfilly_stats_tp
#             custom_effect_tooltip = chungus_stats_tp
#             custom_effect_tooltip = ugandan_stats_tp
# 		}

# 		ai_will_do = {
# 			base = 0
# 		}
# 	}
# }
commonalty_bop_category = {
    comm_WPU_1 = {
        icon = GFX_decision_category_viirats
		allowed = { original_tag = KIC } 
		cost = 33
        visible = {
        }
        available = {
        }
        days_remove = 33
		modifier = {
            power_balance_weekly = -0.033
		}
        complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision comm_WPU_1"
            bac_WPU_small_effect = yes
		}
        remove_effect = {
        }
    }
    comm_COT_1 = {
        icon = GFX_decision_candle
		allowed = { original_tag = KIC }
		cost = 33
        visible = {
        }
        available = {
        }
        days_remove = 33
		modifier = {
            power_balance_weekly = 0.033
		}
        complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision comm_COT_1"
            bac_COT_small_effect = yes
		}
        remove_effect = {
        }
    }
}
foreign_politics = {

	BAC_COC_embassy = {
		icon = SOV_place_hq
		allowed = {
			original_tag = KIC
		}

		ai_will_do = {
			factor = 25
			modifier = {
				FROM = {
					any_neighbor_state = {
						owner = {
							OR = {
								tag = ROOT
								is_ally_with = ROOT
							}
						}
					}
				}
				add = 10
			}
		}

		visible = {
			ROOT = { has_country_flag = bac_diplo_expanded }
			FROM = {
				is_capital = yes
				owner = {
					has_full_control_of_state = PREV
					NOT = {
						has_war_with = ROOT
						has_opinion_modifier = commonalty_embassy
						has_idea = detached_country
					}
					#has_opinion = { target = KIR value > 0 }
					#TODO: should add fucking border or coast check
				}
			}
		}

		state_target = yes # we can put an embassy anywhere
		on_map_mode = map_only
		target_array = COC.COC_EMBASSY_ARRAY
		fire_only_once = yes

		cost = 75
		days_remove = 30

		modifier = {
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision BAC_COC_embassy target: [From.GetName]"
		}
		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove BAC_COC_embassy target: [From.GetName]"
			custom_effect_tooltip = BAC_COC_embassy_tt
			hidden_effect = {
				FROM.owner = {
					add_opinion_modifier = {
						target = ROOT
						modifier = commonalty_embassy
					}
					add_relation_modifier = {
						target = ROOT
						modifier = commonalty_embassy
					}
					ROOT = {
						add_opinion_modifier = {
							target = PREV
							modifier = commonalty_embassy
						}
						add_relation_modifier = {
							target = PREV
							modifier = commonalty_embassy
						}
						add_opinion_modifier = {
							target = PREV
							modifier = commonalty_embassy_trade
						}
					}
				}
			}
		}
		cancel_trigger = {
			FROM.owner = {
				has_war_with = ROOT
			}
		}
	}
	COC_join_faction_decision = {
		icon = generic_protection
		allowed = {
			original_tag = KIC
		}
		ai_will_do = {
			factor = 25
		}

		visible = {
			has_country_flag = commonalty_ending_flag
			is_faction_leader = yes
			is_subject = no
		}

		available = {
			FROM = {
				OR = {
					has_opinion_modifier = commonalty_embassy
					has_opinion = { target = ROOT value > 74 }
				}
				has_war = no
				OR = {
					AND = {
						ROOT = { is_ai = no }
						any_owned_state = {
							is_controlled_by = FROM
							is_coastal = yes
						}
					}
					any_neighbor_country = {
						OR = {
							tag = ROOT
							is_ally_with = ROOT
						}
					}
				}
			}
		}

		target_trigger = {
			FROM = {
				#capital_scope = { is_on_continent = africa }
				OR = {
					has_government = democratic
					has_government = communism
				}
				is_subject = no
				NOT = {
					#original_tag = DEL
					is_in_faction = yes
					is_faction_leader = yes
					is_in_faction_with = ROOT
					has_idea = detached_country
				}
				OR = {
					is_neighbor_of = ROOT
					AND = {
						ROOT = { is_ai = no }
						OR = {
							check_variable = { closest_distance_to@ROOT < 800 }
							ROOT = {
								any_allied_country = {
									OR = {
										check_variable = { closest_distance_to@FROM < 150 }
										is_neighbor_of = FROM
									}
								}
							}
						}
					}
				}
			}
		}

		cost = 75
		days_re_enable = 180

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove COC_join_faction_decision"
			FROM = {
				country_event = baccocc.148
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision COC_join_faction_decision"
		}
	}
}